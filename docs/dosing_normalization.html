<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Haider Inam" />


<title>dosing_normalization</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">duplex_sequencing_screen</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/haiderinam/duplex_sequencing_screen">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">dosing_normalization</h1>
<h4 class="author">Haider Inam</h4>
<h4 class="date">6/1/2020</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2020-07-05
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>duplex_sequencing_screen/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20200402code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20200402)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20200402code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20200402)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomhaiderinamduplexsequencingscreentree8cd26db2f720780a4cbb552e0987a340b608fe6atargetblank8cd26dba"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/haiderinam/duplex_sequencing_screen/tree/8cd26db2f720780a4cbb552e0987a340b608fe6a" target="_blank">8cd26db</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomhaiderinamduplexsequencingscreentree8cd26db2f720780a4cbb552e0987a340b608fe6atargetblank8cd26dba" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/haiderinam/duplex_sequencing_screen/tree/8cd26db2f720780a4cbb552e0987a340b608fe6a" target="_blank">8cd26db</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  analysis/bcrabl_hill_ic50s.csv
    Untracked:  analysis/column_definitions_for_twinstrand_data_06062020.csv
    Untracked:  analysis/dose_response_curve_fitting_with_errorbars.Rmd
    Untracked:  analysis/dosing_normalization_standard_deviations.pdf
    Untracked:  analysis/multinomial_sims.Rmd
    Untracked:  analysis/pooled_growth_fig_corrected_070320.pdf
    Untracked:  analysis/r1r2_1in3000.pdf
    Untracked:  analysis/r1r2_1in5000.pdf
    Untracked:  analysis/r1r3_1in3000.pdf
    Untracked:  analysis/simple_data_generation.Rmd
    Untracked:  analysis/twinstrand_growthrates_simple.csv
    Untracked:  analysis/twinstrand_maf_merge_simple.csv
    Untracked:  analysis/wildtype_growthrates_sequenced.csv
    Untracked:  code/microvariation.normalizer.R
    Untracked:  data/Combined_data_frame_IC_Mutprob_abundance.csv
    Untracked:  data/IC50HeatMap.csv
    Untracked:  data/Twinstrand/
    Untracked:  data/gfpenrichmentdata.csv
    Untracked:  data/heatmap_concat_data.csv
    Untracked:  figures_archive/
    Untracked:  output/archive/
    Untracked:  output/bmes_abstract_51220.pdf
    Untracked:  output/clinicalabundancepredictions_BMES_abstract_51320.pdf
    Untracked:  output/clinicalabundancepredictions_BMES_abstract_52020.pdf
    Untracked:  output/enrichment_simulations_3mutants_52020.pdf
    Untracked:  output/grant_fig.pdf
    Untracked:  output/grant_fig_v2.pdf
    Untracked:  output/grant_fig_v2updated.pdf
    Untracked:  output/ic50data_all_conc.csv
    Untracked:  output/ic50data_all_confidence_intervals_individual_logistic_fits.csv
    Untracked:  output/ic50data_all_confidence_intervals_raw_data.csv
    Untracked:  output/twinstrand_microvariations_normalized.csv
    Untracked:  shinyapp/

Unstaged changes:
    Modified:   analysis/4_7_20_update.Rmd
    Modified:   analysis/E255K_alphas_figure.Rmd
    Modified:   analysis/clinical_abundance_predictions.Rmd
    Modified:   analysis/dose_response_curve_fitting.Rmd
    Modified:   analysis/misc.Rmd
    Modified:   analysis/nonlinear_growth_analysis.Rmd
    Modified:   analysis/spikeins_depthofcoverages.Rmd
    Modified:   analysis/twinstrand_spikeins_data_generation.Rmd
    Deleted:    data/README.md
    Modified:   output/twinstrand_maf_merge.csv
    Modified:   output/twinstrand_simple_melt_merge.csv

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/dosing_normalization.Rmd</code>) and HTML (<code>docs/dosing_normalization.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/8cd26db2f720780a4cbb552e0987a340b608fe6a/analysis/dosing_normalization.Rmd" target="_blank">8cd26db</a>
</td>
<td>
haiderinam
</td>
<td>
2020-07-05
</td>
<td>
wflow_publish(“analysis/dosing_normalization.Rmd”)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/haiderinam/duplex_sequencing_screen/bf79d806cce7e0d0504ae70c2380bb58e64d955e/docs/dosing_normalization.html" target="_blank">bf79d80</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/8671d1bf0178fbcec6725b921a4e0fe3eb7cbaec/analysis/dosing_normalization.Rmd" target="_blank">8671d1b</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
<td>
Fixed figure images and html headings
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/haiderinam/duplex_sequencing_screen/7d36b6191f02dda64f676c9d9c3c245f3ff462f5/docs/dosing_normalization.html" target="_blank">7d36b61</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/haiderinam/duplex_sequencing_screen/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/dosing_normalization.html" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/278a0395a2a480edfa175e549e631f2597c35b0b/analysis/dosing_normalization.Rmd" target="_blank">278a039</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
<td>
added an MCMC method for normalization. Converted normalization into a
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/haiderinam/duplex_sequencing_screen/3e2a9ab0dab4b2ab7a813b1dd538b5a42a29d2d6/docs/dosing_normalization.html" target="_blank">3e2a9ab</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/haiderinam/duplex_sequencing_screen/32f999acdc56eff241ee94e7bdf2ebb5775d0f9a/docs/dosing_normalization.html" target="_blank">32f999a</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/d6a6fd23a1f65cedd71238156e8482869aa7bcf1/analysis/dosing_normalization.Rmd" target="_blank">d6a6fd2</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-02
</td>
<td>
wflow_publish(“analysis/dosing_normalization.Rmd”)
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<p>This is a strategy that uses the observed GFP growth rates to estimate the approximate experimental dose and then normalizes all mutants to behave at that theoretical dose given an arbitrary hill coefficient in a dose response curve.</p>
<div id="part-1-analysis-of-typical-dosing-errors." class="section level3">
<h3>Part 1: Analysis of typical dosing errors.</h3>
<div id="theoretically-how-much-can-an-error-in-dosing-change-the-replicate-to-replicate-heterogeneity-observed-in-an-experiment" class="section level4">
<h4>Theoretically, how much can an error in dosing change the replicate to replicate heterogeneity observed in an experiment?</h4>
<pre class="r"><code>#Looking at data that is off.
#First, I will look at data from IC50 predictions and make a correlation plot of netgr of mutants expected at 625nM vs 1.25uM.
#Next, I will look at whether any of our replicates seemed off
    a=ic50data_long%&gt;%filter(conc%in%c(.6,1.2))
    a_cast=dcast(a,mutant~conc)</code></pre>
<pre><code>Using netgr_pred as value column: use value.var to override.</code></pre>
<pre class="r"><code># library(reshape2)
ic50data_cast=dcast(ic50data_long,mutant~conc)</code></pre>
<pre><code>Using netgr_pred as value column: use value.var to override.</code></pre>
<pre class="r"><code>ic50data_cast6=ic50data_cast%&gt;%dplyr::select(mutant,`0.9`)
a=ic50data_long%&gt;%filter(conc==0.9)
# ic50data_long$`0.6`=ic50data_long%&gt;%filter(conc==0.6)%&gt;%dplyr::select(netgr_pred)
a=merge(ic50data_cast6,ic50data_long,by=&quot;mutant&quot;)
# ic50data_long$`0.6`=ic50data_cast$`0.6`
# ic50data_long=ic50data_long%&gt;%mutate(`0.6`=ic50data_cast$`0.6`)
a=a%&gt;%filter(conc%in%c(.4,.6,.8,1,1.2,1.4))
getPalette = colorRampPalette(brewer.pal(6, &quot;Spectral&quot;))
plotly=ggplot(a,aes(x=`0.9`,y=netgr_pred))+
  geom_abline()+
  geom_point(color=&quot;black&quot;,shape=21,size=3,aes(fill=factor(conc)))+
  scale_fill_manual(values = getPalette(length(unique(a$conc))))+
  cleanup
ggplotly(plotly)</code></pre>
<div id="htmlwidget-ca9da69111fdc3e9e442" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ca9da69111fdc3e9e442">{"x":{"data":[{"x":[-0.00302623008858855,0.0577617217435411],"y":[-0.00302623008858855,0.0577617217435411],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0235097115121764,0.0499526594893793,0.0549986330238988,0.019212213975525,0.0322415202341068,0.0159666363211725,0.0287868672534048,0.0412442997623182,0.0286591978684391,0.0287013336217085,0.0527077901254519,0.0490711800079895,0.0523489763687433,0.0403933031524683,0.0430930183188287,0.0306716679699237,0.04744009146848,0.0519052352625888,-0.000263141368946299,0.0147574473905503,0.047735750025161,0.0547488063398909],"y":[0.0376499464618692,0.0543974570590086,0.0549999763048655,0.0464998747521374,0.0473951609270791,0.0416525317009043,0.047113711106914,0.0535881494323671,0.0436234923909639,0.0509484991399547,0.0548217001606845,0.052998700415437,0.0545919824856392,0.0468884373871778,0.0524000676502574,0.0495053549479525,0.0540434901590641,0.0533946931686485,0.0244718698144405,0.0321957851012343,0.0528412778064973,0.0549683850437213],"text":["factor(conc): 0.4<br />0.9:  0.0235097115<br />netgr_pred:  0.0376499465","factor(conc): 0.4<br />0.9:  0.0499526595<br />netgr_pred:  0.0543974571","factor(conc): 0.4<br />0.9:  0.0549986330<br />netgr_pred:  0.0549999763","factor(conc): 0.4<br />0.9:  0.0192122140<br />netgr_pred:  0.0464998748","factor(conc): 0.4<br />0.9:  0.0322415202<br />netgr_pred:  0.0473951609","factor(conc): 0.4<br />0.9:  0.0159666363<br />netgr_pred:  0.0416525317","factor(conc): 0.4<br />0.9:  0.0287868673<br />netgr_pred:  0.0471137111","factor(conc): 0.4<br />0.9:  0.0412442998<br />netgr_pred:  0.0535881494","factor(conc): 0.4<br />0.9:  0.0286591979<br />netgr_pred:  0.0436234924","factor(conc): 0.4<br />0.9:  0.0287013336<br />netgr_pred:  0.0509484991","factor(conc): 0.4<br />0.9:  0.0527077901<br />netgr_pred:  0.0548217002","factor(conc): 0.4<br />0.9:  0.0490711800<br />netgr_pred:  0.0529987004","factor(conc): 0.4<br />0.9:  0.0523489764<br />netgr_pred:  0.0545919825","factor(conc): 0.4<br />0.9:  0.0403933032<br />netgr_pred:  0.0468884374","factor(conc): 0.4<br />0.9:  0.0430930183<br />netgr_pred:  0.0524000677","factor(conc): 0.4<br />0.9:  0.0306716680<br />netgr_pred:  0.0495053549","factor(conc): 0.4<br />0.9:  0.0474400915<br />netgr_pred:  0.0540434902","factor(conc): 0.4<br />0.9:  0.0519052353<br />netgr_pred:  0.0533946932","factor(conc): 0.4<br />0.9: -0.0002631414<br />netgr_pred:  0.0244718698","factor(conc): 0.4<br />0.9:  0.0147574474<br />netgr_pred:  0.0321957851","factor(conc): 0.4<br />0.9:  0.0477357500<br />netgr_pred:  0.0528412778","factor(conc): 0.4<br />0.9:  0.0547488063<br />netgr_pred:  0.0549683850"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(213,62,79,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"0.4","legendgroup":"0.4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0235097115121764,0.0499526594893793,0.0549986330238988,0.019212213975525,0.0322415202341068,0.0159666363211725,0.0287868672534048,0.0412442997623182,0.0286591978684391,0.0287013336217085,0.0527077901254519,0.0490711800079895,0.0523489763687433,0.0403933031524683,0.0430930183188287,0.0306716679699237,0.04744009146848,0.0519052352625888,-0.000263141368946299,0.0147574473905503,0.047735750025161,0.0547488063398909],"y":[0.0309748751161023,0.0531875825407339,0.0549998200225446,0.0350581886015012,0.0410059214098851,0.0300658549577078,0.0394242569291453,0.0500757394502016,0.0369034879460592,0.0429425415855831,0.0543468520979452,0.0514926652160179,0.0539416130951769,0.043951776521271,0.0491071177913939,0.0421602148035571,0.0521575244787383,0.0527615975616027,0.0123910916009237,0.023810924638824,0.0509359754957116,0.0549107172029299],"text":["factor(conc): 0.6<br />0.9:  0.0235097115<br />netgr_pred:  0.0309748751","factor(conc): 0.6<br />0.9:  0.0499526595<br />netgr_pred:  0.0531875825","factor(conc): 0.6<br />0.9:  0.0549986330<br />netgr_pred:  0.0549998200","factor(conc): 0.6<br />0.9:  0.0192122140<br />netgr_pred:  0.0350581886","factor(conc): 0.6<br />0.9:  0.0322415202<br />netgr_pred:  0.0410059214","factor(conc): 0.6<br />0.9:  0.0159666363<br />netgr_pred:  0.0300658550","factor(conc): 0.6<br />0.9:  0.0287868673<br />netgr_pred:  0.0394242569","factor(conc): 0.6<br />0.9:  0.0412442998<br />netgr_pred:  0.0500757395","factor(conc): 0.6<br />0.9:  0.0286591979<br />netgr_pred:  0.0369034879","factor(conc): 0.6<br />0.9:  0.0287013336<br />netgr_pred:  0.0429425416","factor(conc): 0.6<br />0.9:  0.0527077901<br />netgr_pred:  0.0543468521","factor(conc): 0.6<br />0.9:  0.0490711800<br />netgr_pred:  0.0514926652","factor(conc): 0.6<br />0.9:  0.0523489764<br />netgr_pred:  0.0539416131","factor(conc): 0.6<br />0.9:  0.0403933032<br />netgr_pred:  0.0439517765","factor(conc): 0.6<br />0.9:  0.0430930183<br />netgr_pred:  0.0491071178","factor(conc): 0.6<br />0.9:  0.0306716680<br />netgr_pred:  0.0421602148","factor(conc): 0.6<br />0.9:  0.0474400915<br />netgr_pred:  0.0521575245","factor(conc): 0.6<br />0.9:  0.0519052353<br />netgr_pred:  0.0527615976","factor(conc): 0.6<br />0.9: -0.0002631414<br />netgr_pred:  0.0123910916","factor(conc): 0.6<br />0.9:  0.0147574474<br />netgr_pred:  0.0238109246","factor(conc): 0.6<br />0.9:  0.0477357500<br />netgr_pred:  0.0509359755","factor(conc): 0.6<br />0.9:  0.0547488063<br />netgr_pred:  0.0549107172"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(252,141,89,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"0.6","legendgroup":"0.6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0235097115121764,0.0499526594893793,0.0549986330238988,0.019212213975525,0.0322415202341068,0.0159666363211725,0.0287868672534048,0.0412442997623182,0.0286591978684391,0.0287013336217085,0.0527077901254519,0.0490711800079895,0.0523489763687433,0.0403933031524683,0.0430930183188287,0.0306716679699237,0.04744009146848,0.0519052352625888,-0.000263141368946299,0.0147574473905503,0.047735750025161,0.0547488063398909],"y":[0.0257418387583982,0.0512052973681712,0.0549992414620763,0.0241017269555896,0.0349947477543113,0.0202220859290129,0.0321163581969614,0.0444771573794523,0.0311802963312629,0.033358832912393,0.0533956551471867,0.0498865814484791,0.0529583690596403,0.0414890250809361,0.0451543018149349,0.0343623358928991,0.0492148631880428,0.0521803272541696,0.0034474697760641,0.0174363150294186,0.0488231510097852,0.0548138802355524],"text":["factor(conc): 0.8<br />0.9:  0.0235097115<br />netgr_pred:  0.0257418388","factor(conc): 0.8<br />0.9:  0.0499526595<br />netgr_pred:  0.0512052974","factor(conc): 0.8<br />0.9:  0.0549986330<br />netgr_pred:  0.0549992415","factor(conc): 0.8<br />0.9:  0.0192122140<br />netgr_pred:  0.0241017270","factor(conc): 0.8<br />0.9:  0.0322415202<br />netgr_pred:  0.0349947478","factor(conc): 0.8<br />0.9:  0.0159666363<br />netgr_pred:  0.0202220859","factor(conc): 0.8<br />0.9:  0.0287868673<br />netgr_pred:  0.0321163582","factor(conc): 0.8<br />0.9:  0.0412442998<br />netgr_pred:  0.0444771574","factor(conc): 0.8<br />0.9:  0.0286591979<br />netgr_pred:  0.0311802963","factor(conc): 0.8<br />0.9:  0.0287013336<br />netgr_pred:  0.0333588329","factor(conc): 0.8<br />0.9:  0.0527077901<br />netgr_pred:  0.0533956551","factor(conc): 0.8<br />0.9:  0.0490711800<br />netgr_pred:  0.0498865814","factor(conc): 0.8<br />0.9:  0.0523489764<br />netgr_pred:  0.0529583691","factor(conc): 0.8<br />0.9:  0.0403933032<br />netgr_pred:  0.0414890251","factor(conc): 0.8<br />0.9:  0.0430930183<br />netgr_pred:  0.0451543018","factor(conc): 0.8<br />0.9:  0.0306716680<br />netgr_pred:  0.0343623359","factor(conc): 0.8<br />0.9:  0.0474400915<br />netgr_pred:  0.0492148632","factor(conc): 0.8<br />0.9:  0.0519052353<br />netgr_pred:  0.0521803273","factor(conc): 0.8<br />0.9: -0.0002631414<br />netgr_pred:  0.0034474698","factor(conc): 0.8<br />0.9:  0.0147574474<br />netgr_pred:  0.0174363150","factor(conc): 0.8<br />0.9:  0.0477357500<br />netgr_pred:  0.0488231510","factor(conc): 0.8<br />0.9:  0.0547488063<br />netgr_pred:  0.0548138802"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(254,224,139,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"0.8","legendgroup":"0.8","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0235097115121764,0.0499526594893793,0.0549986330238988,0.019212213975525,0.0322415202341068,0.0159666363211725,0.0287868672534048,0.0412442997623182,0.0286591978684391,0.0287013336217085,0.0527077901254519,0.0490711800079895,0.0523489763687433,0.0403933031524683,0.0430930183188287,0.0306716679699237,0.04744009146848,0.0519052352625888,-0.000263141368946299,0.0147574473905503,0.047735750025161,0.0547488063398909],"y":[0.0214769560194429,0.0485579566578466,0.0549976849474369,0.0147120949040813,0.0296605320183623,0.0120865566486941,0.025680869658798,0.037911102122817,0.0263326734714405,0.0242806112035779,0.0518722952610035,0.0482562806324257,0.0516685812522742,0.0393719990092723,0.0410337501004661,0.0271829077515485,0.0455297022482262,0.0516391083905253,-0.0035987285878677,0.0123350230144442,0.0466446095054954,0.0546717575928041],"text":["factor(conc): 1<br />0.9:  0.0235097115<br />netgr_pred:  0.0214769560","factor(conc): 1<br />0.9:  0.0499526595<br />netgr_pred:  0.0485579567","factor(conc): 1<br />0.9:  0.0549986330<br />netgr_pred:  0.0549976849","factor(conc): 1<br />0.9:  0.0192122140<br />netgr_pred:  0.0147120949","factor(conc): 1<br />0.9:  0.0322415202<br />netgr_pred:  0.0296605320","factor(conc): 1<br />0.9:  0.0159666363<br />netgr_pred:  0.0120865566","factor(conc): 1<br />0.9:  0.0287868673<br />netgr_pred:  0.0256808697","factor(conc): 1<br />0.9:  0.0412442998<br />netgr_pred:  0.0379111021","factor(conc): 1<br />0.9:  0.0286591979<br />netgr_pred:  0.0263326735","factor(conc): 1<br />0.9:  0.0287013336<br />netgr_pred:  0.0242806112","factor(conc): 1<br />0.9:  0.0527077901<br />netgr_pred:  0.0518722953","factor(conc): 1<br />0.9:  0.0490711800<br />netgr_pred:  0.0482562806","factor(conc): 1<br />0.9:  0.0523489764<br />netgr_pred:  0.0516685813","factor(conc): 1<br />0.9:  0.0403933032<br />netgr_pred:  0.0393719990","factor(conc): 1<br />0.9:  0.0430930183<br />netgr_pred:  0.0410337501","factor(conc): 1<br />0.9:  0.0306716680<br />netgr_pred:  0.0271829078","factor(conc): 1<br />0.9:  0.0474400915<br />netgr_pred:  0.0455297022","factor(conc): 1<br />0.9:  0.0519052353<br />netgr_pred:  0.0516391084","factor(conc): 1<br />0.9: -0.0002631414<br />netgr_pred: -0.0035987286","factor(conc): 1<br />0.9:  0.0147574474<br />netgr_pred:  0.0123350230","factor(conc): 1<br />0.9:  0.0477357500<br />netgr_pred:  0.0466446095","factor(conc): 1<br />0.9:  0.0547488063<br />netgr_pred:  0.0546717576"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(230,245,152,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0235097115121764,0.0499526594893793,0.0549986330238988,0.019212213975525,0.0322415202341068,0.0159666363211725,0.0287868672534048,0.0412442997623182,0.0286591978684391,0.0287013336217085,0.0527077901254519,0.0490711800079895,0.0523489763687433,0.0403933031524683,0.0430930183188287,0.0306716679699237,0.04744009146848,0.0519052352625888,-0.000263141368946299,0.0147574473905503,0.047735750025161,0.0547488063398909],"y":[0.0178913225720178,0.0454582547344839,0.0549942394962362,0.0067324494566664,0.0249757032018735,0.005254986970131,0.0200822523111883,0.0313055574599957,0.0221738451431348,0.0162285676292888,0.0497789188802473,0.0466450801373125,0.0501241362638409,0.0375171204586182,0.0370225335503402,0.0208244530256364,0.0414861244200873,0.0511306661889051,-0.009397817344888,0.0080959566810072,0.0444842821268533,0.0544796186019823],"text":["factor(conc): 1.2<br />0.9:  0.0235097115<br />netgr_pred:  0.0178913226","factor(conc): 1.2<br />0.9:  0.0499526595<br />netgr_pred:  0.0454582547","factor(conc): 1.2<br />0.9:  0.0549986330<br />netgr_pred:  0.0549942395","factor(conc): 1.2<br />0.9:  0.0192122140<br />netgr_pred:  0.0067324495","factor(conc): 1.2<br />0.9:  0.0322415202<br />netgr_pred:  0.0249757032","factor(conc): 1.2<br />0.9:  0.0159666363<br />netgr_pred:  0.0052549870","factor(conc): 1.2<br />0.9:  0.0287868673<br />netgr_pred:  0.0200822523","factor(conc): 1.2<br />0.9:  0.0412442998<br />netgr_pred:  0.0313055575","factor(conc): 1.2<br />0.9:  0.0286591979<br />netgr_pred:  0.0221738451","factor(conc): 1.2<br />0.9:  0.0287013336<br />netgr_pred:  0.0162285676","factor(conc): 1.2<br />0.9:  0.0527077901<br />netgr_pred:  0.0497789189","factor(conc): 1.2<br />0.9:  0.0490711800<br />netgr_pred:  0.0466450801","factor(conc): 1.2<br />0.9:  0.0523489764<br />netgr_pred:  0.0501241363","factor(conc): 1.2<br />0.9:  0.0403933032<br />netgr_pred:  0.0375171205","factor(conc): 1.2<br />0.9:  0.0430930183<br />netgr_pred:  0.0370225336","factor(conc): 1.2<br />0.9:  0.0306716680<br />netgr_pred:  0.0208244530","factor(conc): 1.2<br />0.9:  0.0474400915<br />netgr_pred:  0.0414861244","factor(conc): 1.2<br />0.9:  0.0519052353<br />netgr_pred:  0.0511306662","factor(conc): 1.2<br />0.9: -0.0002631414<br />netgr_pred: -0.0093978173","factor(conc): 1.2<br />0.9:  0.0147574474<br />netgr_pred:  0.0080959567","factor(conc): 1.2<br />0.9:  0.0477357500<br />netgr_pred:  0.0444842821","factor(conc): 1.2<br />0.9:  0.0547488063<br />netgr_pred:  0.0544796186"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(153,213,148,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"1.2","legendgroup":"1.2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0235097115121764,0.0499526594893793,0.0549986330238988,0.019212213975525,0.0322415202341068,0.0159666363211725,0.0287868672534048,0.0412442997623182,0.0286591978684391,0.0287013336217085,0.0527077901254519,0.0490711800079895,0.0523489763687433,0.0403933031524683,0.0430930183188287,0.0306716679699237,0.04744009146848,0.0519052352625888,-0.000263141368946299,0.0147574473905503,0.047735750025161,0.0547488063398909],"y":[0.014804064803952,0.0421257883918136,0.0549875511343426,-0.000137069036006403,0.0208427326355853,-0.000600474737850902,0.0151826338981246,0.0250860734207122,0.0185512185486546,0.009159267546414,0.0472080535565045,0.0450770260133821,0.0483881011938699,0.0358674091580173,0.0332408564421902,0.0152181641186716,0.0373770928988521,0.0506499785182644,-0.0143200780548803,0.0044749927454031,0.042388174862519,0.0542340325536766],"text":["factor(conc): 1.4<br />0.9:  0.0235097115<br />netgr_pred:  0.0148040648","factor(conc): 1.4<br />0.9:  0.0499526595<br />netgr_pred:  0.0421257884","factor(conc): 1.4<br />0.9:  0.0549986330<br />netgr_pred:  0.0549875511","factor(conc): 1.4<br />0.9:  0.0192122140<br />netgr_pred: -0.0001370690","factor(conc): 1.4<br />0.9:  0.0322415202<br />netgr_pred:  0.0208427326","factor(conc): 1.4<br />0.9:  0.0159666363<br />netgr_pred: -0.0006004747","factor(conc): 1.4<br />0.9:  0.0287868673<br />netgr_pred:  0.0151826339","factor(conc): 1.4<br />0.9:  0.0412442998<br />netgr_pred:  0.0250860734","factor(conc): 1.4<br />0.9:  0.0286591979<br />netgr_pred:  0.0185512185","factor(conc): 1.4<br />0.9:  0.0287013336<br />netgr_pred:  0.0091592675","factor(conc): 1.4<br />0.9:  0.0527077901<br />netgr_pred:  0.0472080536","factor(conc): 1.4<br />0.9:  0.0490711800<br />netgr_pred:  0.0450770260","factor(conc): 1.4<br />0.9:  0.0523489764<br />netgr_pred:  0.0483881012","factor(conc): 1.4<br />0.9:  0.0403933032<br />netgr_pred:  0.0358674092","factor(conc): 1.4<br />0.9:  0.0430930183<br />netgr_pred:  0.0332408564","factor(conc): 1.4<br />0.9:  0.0306716680<br />netgr_pred:  0.0152181641","factor(conc): 1.4<br />0.9:  0.0474400915<br />netgr_pred:  0.0373770929","factor(conc): 1.4<br />0.9:  0.0519052353<br />netgr_pred:  0.0506499785","factor(conc): 1.4<br />0.9: -0.0002631414<br />netgr_pred: -0.0143200781","factor(conc): 1.4<br />0.9:  0.0147574474<br />netgr_pred:  0.0044749927","factor(conc): 1.4<br />0.9:  0.0477357500<br />netgr_pred:  0.0423881749","factor(conc): 1.4<br />0.9:  0.0547488063<br />netgr_pred:  0.0542340326"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(50,136,189,1)","opacity":1,"size":11.3385826771654,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"1.4","legendgroup":"1.4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":43.1050228310502,"l":54.7945205479452},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.00302623008858855,0.0577617217435411],"tickmode":"array","ticktext":["0.00","0.02","0.04"],"tickvals":[0,0.02,0.04],"categoryorder":"array","categoryarray":["0.00","0.02","0.04"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"<b> 0.9 <\/b>","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0177860807728676,0.0584659790228528],"tickmode":"array","ticktext":["0.00","0.02","0.04"],"tickvals":[0,0.02,0.04],"categoryorder":"array","categoryarray":["0.00","0.02","0.04"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"<b> netgr_pred <\/b>","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"factor(conc)","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"158822447472":{"intercept":{},"slope":{},"type":"scatter"},"15883c38f9f1":{"fill":{},"x":{},"y":{}}},"cur_data":"158822447472","visdat":{"158822447472":["function (y) ","x"],"15883c38f9f1":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>########Making figure with predicted growth over various concentrations
ic50data_cast=dcast(ic50data_long,mutant~conc)</code></pre>
<pre><code>Using netgr_pred as value column: use value.var to override.</code></pre>
<pre class="r"><code>ic50data_cast6=ic50data_cast%&gt;%dplyr::select(mutant,`0.8`)
a=merge(ic50data_cast6,ic50data_long,by=&quot;mutant&quot;)
a=a%&gt;%filter(conc%in%c(.4,.8,1.2))

####Sorting mutants from more to less resistant
ic50data_long_625=a%&gt;%filter(conc==.8)
a$mutant=factor(a$mutant,levels = as.character(ic50data_long_625$mutant[order((ic50data_long_625$y),decreasing = T)]))
###
getPalette = colorRampPalette(brewer.pal(3, &quot;Spectral&quot;))
ggplot(a,aes(x=`0.8`,y=netgr_pred))+
  geom_abline()+
  geom_point(color=&quot;black&quot;,shape=21,size=4,aes(fill=factor(conc)))+
  scale_x_continuous(limits=c(-.01,.06),name=&quot;Theoretical Growth rate&quot;)+
  scale_y_continuous(limits=c(-.01,.06),name=&quot;Theoretical Growth rate with 50% error in dose&quot;)+
  scale_fill_manual(values = getPalette(length(unique(a$conc))))+
  cleanup+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-2-2">
Past versions of unnamed-chunk-2-2.png
</button>
</p>
<div id="fig-unnamed-chunk-2-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-2-2.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/32f999acdc56eff241ee94e7bdf2ebb5775d0f9a/docs/figure/dosing_normalization.Rmd/unnamed-chunk-2-2.png" target="_blank">32f999a</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># ggsave(&quot;dosing_error_r1r2.pdf&quot;,width=3,height=3,units=&quot;in&quot;,useDingbats=F)

ggplot(a,aes(x=mutant,y=netgr_pred,color=factor(conc)))+
  geom_abline()+
  geom_point(color=&quot;black&quot;,shape=21,size=4,aes(fill=factor(conc)))+
  # scale_x_continuous(limits=c(1.33/72,1.405/72),name=&quot;Theoretical Growth rate \nat intended concentration&quot;)+
  scale_y_continuous(limits=c(-.01,.06),name=&quot;Theoretical Growth rate&quot;)+
  scale_fill_manual(values = getPalette(length(unique(a$conc))))+
  cleanup+
  theme(legend.position = &quot;none&quot;,
        axis.title.x = element_blank(),
        axis.text.x=element_text(angle=90,hjust=.5,vjust=.5))</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-2-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-2-3">
Past versions of unnamed-chunk-2-3.png
</button>
</p>
<div id="fig-unnamed-chunk-2-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-2-3.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/32f999acdc56eff241ee94e7bdf2ebb5775d0f9a/docs/figure/dosing_normalization.Rmd/unnamed-chunk-2-3.png" target="_blank">32f999a</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># ggsave(&quot;dosing_error_r1mutant.pdf&quot;,width=5,height=3,units=&quot;in&quot;,useDingbats=F)</code></pre>
</div>
</div>
<div id="part-2-hill-coefficient-analysis." class="section level3">
<h3>Part 2: Hill Coefficient Analysis.</h3>
<div id="what-hill-coefficient-to-use-when-inferring-growth-rates-based-on-apparent-dose" class="section level4">
<h4>What Hill Coefficient to Use When inferring growth rates based on apparent dose?</h4>
<p>We’ll need to assume a hill coefficient if we want to normalize the dose response of these mutants. Below, you will see that the typical hill coefficient in our dataset is centered around 2-3. Therefore, it is safe to assume that the hill coefficient for all the mutants is around the one forthe standard (E255K)</p>
<pre class="r"><code>ic50data=read.csv(&quot;data/heatmap_concat_data.csv&quot;,header = T,stringsAsFactors = F)
# ic50data=read.csv(&quot;../data/heatmap_concat_data.csv&quot;,header = T,stringsAsFactors = F)
ic50data=ic50data[c(1:10),]
ic50data_long=melt(ic50data,id.vars = &quot;conc&quot;,variable.name = &quot;species&quot;,value.name = &quot;y&quot;)
#Removing useless mutants (for example keeping only maxipreps and removing low growth rate mutants)
ic50data_long=ic50data_long%&gt;%filter(species%in%c(&quot;Wt&quot;,&quot;V299L_H&quot;,&quot;E355A&quot;,&quot;D276G_maxi&quot;,&quot;H396R&quot;,&quot;F317L&quot;,&quot;F359I&quot;,&quot;E459K&quot;,&quot;G250E&quot;,&quot;F359C&quot;,&quot;F359V&quot;,&quot;M351T&quot;,&quot;L248V&quot;,&quot;E355G_maxi&quot;,&quot;Q252H_maxi&quot;,&quot;Y253F&quot;,&quot;F486S_maxi&quot;,&quot;H396P_maxi&quot;,&quot;E255K&quot;,&quot;Y253H&quot;,&quot;T315I&quot;,&quot;E255V&quot;))
#Making standardized names
ic50data_long$mutant=ic50data_long$species
ic50data_long=ic50data_long%&gt;%
  # filter(conc==&quot;0.625&quot;)%&gt;%
  # filter(conc==&quot;1.25&quot;)%&gt;%
  mutate(mutant=case_when(species==&quot;F486S_maxi&quot;~&quot;F486S&quot;,
                          species==&quot;H396P_maxi&quot;~&quot;H396P&quot;,
                          species==&quot;Q252H_maxi&quot;~&quot;Q252H&quot;,
                          species==&quot;E355G_maxi&quot;~&quot;E355G&quot;,
                          species==&quot;D276G_maxi&quot;~&quot;D276G&quot;,
                          species==&quot;V299L_H&quot; ~ &quot;V299L&quot;,
                          species==mutant ~as.character(mutant)))

# ic50data_long_625$species[order((ic50data_long_625$y),decreasing = T)]

#In the next step, I&#39;m ordering mutants by decreasing resposne to the 625nM dose. Then I use this to change the levels of the species factor from more to less resistant. This helps with ggplot because now I can color the mutants with decreasing resistance
ic50data_long_625=ic50data_long%&gt;%filter(conc==.625)
ic50data_long$species=factor(ic50data_long$species,levels = as.character(ic50data_long_625$species[order((ic50data_long_625$y),decreasing = T)]))
ic50data_long$mutant=factor(ic50data_long$mutant,levels = as.character(ic50data_long_625$mutant[order((ic50data_long_625$y),decreasing = T)]))

########Four parameter logistic########
#Reference: https://journals.plos.org/plosone/article/file?type=supplementary&amp;id=info:doi/10.1371/journal.pone.0146021.s001
#In short: For each dose in each species, get the response
# rm(list=ls())
ic50data_long_model=data.frame()
# hill_coefficients=data.frame()
hill_coefficients_cum=data.frame()
ic50data_long$species=ic50data_long$mutant
for (species_curr in sort(unique(ic50data_long$species))){
  ic50data_species_specific=ic50data_long%&gt;%filter(species==species_curr)
  x=ic50data_species_specific$conc
  y=ic50data_species_specific$y
  #Next: Appproximating Response from dose (inverse of the prediction)
  ic50.ll4=drm(y~conc,data=ic50data_long%&gt;%filter(species==species_curr),fct=LL.3(fixed=c(NA,1,NA)))
    b=coef(ic50.ll4)[1]
    c=0
    d=1
    e=coef(ic50.ll4)[2]
  ###Getting predictions
  ic50data_species_specific=ic50data_species_specific%&gt;%group_by(conc)%&gt;%mutate(y_model=c+((d-c)/(1+exp(b*(log(conc)-log(e))))))
  ic50data_species_specific=data.frame(ic50data_species_specific) #idk why I have to end up doing this
  ic50data_long_model=rbind(ic50data_long_model,ic50data_species_specific)
  hill_coefficients_curr=data.frame(cbind(species_curr,b,e))
  # hill_coefficients$species=species_curr
  # hill_coefficients$hill=b
  hill_coefficients_cum=rbind(hill_coefficients_cum,hill_coefficients_curr)
}
ic50data_long=ic50data_long_model

#In the next step, I&#39;m ordering mutants by decreasing resposne to the 625nM dose. Then I use this to change the levels of the species factor from more to less resistant. This helps with ggplot because now I can color the mutants with decreasing resistance
ic50data_long_625=ic50data_long%&gt;%filter(conc==.625)
ic50data_long$species=factor(ic50data_long$species,levels = as.character(ic50data_long_625$species[order((ic50data_long_625$y_model),decreasing = T)]))

#Adding drug effect
##########Changed this on 2/20. Using y from 4 parameter logistic rather than raw values
ic50data_long=ic50data_long%&gt;%
  filter(!species==&quot;Wt&quot;)%&gt;%
  mutate(drug_effect=-log(y_model)/72)

#Adding Net growth rate
ic50data_long$netgr_pred=.05-ic50data_long$drug_effect

hill_coefficients_cum$b=as.numeric(hill_coefficients_cum$b)
ggplot(hill_coefficients_cum,aes(b))+geom_histogram()</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-1">
Past versions of unnamed-chunk-3-1.png
</button>
</p>
<div id="fig-unnamed-chunk-3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-3-1.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ggplot(hill_coefficients_cum,aes(x=species_curr,y=b))+geom_point()</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-3-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-2">
Past versions of unnamed-chunk-3-2.png
</button>
</p>
<div id="fig-unnamed-chunk-3-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-3-2.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>#Maybe we can assume a hill of 2?



###Preparing spreadsheet of hill coefficients for MCMC. 06072020
a=hill_coefficients_cum%&gt;%dplyr::select(mutant=species_curr,hill_coef=b,ic50=e)
rownames(a)=NULL
# write.csv(a,&quot;bcrabl_hill_ic50s.csv&quot;)</code></pre>
</div>
</div>
<div id="part-3-correcting-microvariations." class="section level3">
<h3>Part 3: Correcting microvariations.</h3>
<div id="dosing-normalization-function-that-corrects-for-microvariations." class="section level4">
<h4>Dosing normalization function that corrects for microvariations.</h4>
</div>
<div id="now-that-we-know-that-an-off-dose-can-have-massive-implications-on-the-replicate-to-replicate-agreement-we-are-going-to-correct-it." class="section level4">
<h4>Now that we know that an off dose can have massive implications on the replicate to replicate agreement, we are going to correct it.</h4>
</div>
<div id="method-1-use-the-apparent-dose-of-the-standard-e255k-in-this-case-to-normalize-the-growth-rates-of-the-other-mutants-to-the-same-apparent-dose" class="section level4">
<h4>Method 1: Use the apparent dose of the standard (E255K in this case) to normalize the growth rates of the other mutants to the same apparent dose</h4>
<p>Using the dosing normalization function</p>
<pre class="r"><code>####First, we choose our model experiment and calculate the apparent dose at that model experiment using the net growth rate of the standard.
#Apparent dose of E255K (standard) for M3 (model experiment)
# ((1-exp((net_gr_wodrug-0.033481)*time))*-(ic50_standard^hill_standard))^(1/hill_standard)
#We will use this as the apparent dose for our model experiment. Will normalize all other experiments to this dose.
# twinstrand_simple_melt_merge=read.csv(&quot;../output/twinstrand_simple_melt_merge.csv&quot;,header = T,stringsAsFactors = F,row.names=1)
twinstrand_simple_melt_merge=read.csv(&quot;output/twinstrand_simple_melt_merge.csv&quot;,header = T,stringsAsFactors = F,row.names=1)

# source(&quot;../code/microvariation.normalizer.R&quot;)
source(&quot;code/microvariation.normalizer.R&quot;)

#Focusing on the non-ENU experiments
twinstrand_simple_melt_merge=twinstrand_simple_melt_merge%&gt;%filter(!experiment%in%c(&quot;Enu_3&quot;,&quot;Enu_4&quot;))
net_gr_wodrug=0.055
time=72
hill_standard=2.83 #E255K Hill
ic50_standard=1.205 #E255K IC50
standard_name=&quot;E255K&quot;
dose_model=1.9147 #M3 dose

netgr_corrected_compiled=data.frame()
dose_apparent_compiled=data.frame()
for(experiment_current in unique(twinstrand_simple_melt_merge$experiment)){
  netgr_raw=twinstrand_simple_melt_merge%&gt;%
    filter(experiment==experiment_current,duration==&quot;d3d6&quot;)%&gt;%
    dplyr::select(experiment,mutant,netgr_obs)
  
  ###For one experiment###
  netgr_corrected_experiment=microvariation.normalizer(netgr_raw,
                                     net_gr_wodrug,
                                     hill_standard,
                                     ic50_standard,
                                     dose_model,
                                     time,
                                     standard_name)[[1]]
  #Dose apparent
  dose_apparent_experiment=microvariation.normalizer(netgr_raw,
                                     net_gr_wodrug,
                                     hill_standard,
                                     ic50_standard,
                                     dose_model,
                                     time,
                                     standard_name)[[2]]

  netgr_corrected_compiled=rbind(netgr_corrected_experiment,netgr_corrected_compiled) #Of course faster way would be pre-allocating for efficiency
  dose_apparent_compiled=rbind(c(experiment_current,dose_apparent_experiment),dose_apparent_compiled)
}
#adding m3&#39;s growth rates as the model
netgr_corrected_compiled=merge(netgr_corrected_compiled,netgr_corrected_compiled%&gt;%filter(experiment%in%&quot;M3&quot;)%&gt;%dplyr::select(mutant,netgr_model_m3=netgr_obs),by=&quot;mutant&quot;)
netgr_corrected_compiled=merge(netgr_corrected_compiled,netgr_corrected_compiled%&gt;%filter(experiment%in%&quot;M4&quot;)%&gt;%dplyr::select(mutant,netgr_model_m4=netgr_obs),by=&quot;mutant&quot;)
# #Adding all experiments
# for experiment_curr%in%sort(unique(netgr_corrected_compiled$experiment)){
#   
# }

ggplot(netgr_corrected_compiled,aes(x=netgr_model_m3,y=netgr_obs,color=experiment))+geom_point()+geom_abline()</code></pre>
<pre><code>Warning: Removed 10 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-1">
Past versions of unnamed-chunk-4-1.png
</button>
</p>
<div id="fig-unnamed-chunk-4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-4-1.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/32f999acdc56eff241ee94e7bdf2ebb5775d0f9a/docs/figure/dosing_normalization.Rmd/unnamed-chunk-4-1.png" target="_blank">32f999a</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ggplot(netgr_corrected_compiled,aes(x=netgr_model_m3,y=netgr_obs_corrected,color=experiment))+geom_point()+geom_abline()</code></pre>
<pre><code>Warning: Removed 10 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-4-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-2">
Past versions of unnamed-chunk-4-2.png
</button>
</p>
<div id="fig-unnamed-chunk-4-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-4-2.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/32f999acdc56eff241ee94e7bdf2ebb5775d0f9a/docs/figure/dosing_normalization.Rmd/unnamed-chunk-4-2.png" target="_blank">32f999a</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>###Looking at whether we can correct by mean growth rate for E255K
# netgr_model=netgr_corrected_compiled%&gt;%group_by(mutant)%&gt;%summarize(netgr_model=mean(netgr_obs,na.rm=T),netgr_model_corrected=mean(netgr_obs_corrected,na.rm=T))
# ggplot(netgr_model,aes(x=netgr_model,y=netgr_model_corrected))+geom_point()+geom_abline()
# a=merge(netgr_corrected_compiled,netgr_model,by=&quot;mutant&quot;)
# ggplot(a,aes(x=netgr_model,y=netgr_obs_corrected,color=experiment))+geom_point()+geom_abline()
# ggplot(a,aes(x=netgr_model_corrected,y=netgr_obs_corrected,color=experiment))+geom_point()+geom_abline()

#Problem right now: For stuff that has a growth rate higher than netgr_obs, how do you correct it? Because those things apparently have an infinite IC50    
####Calculating mean squared error
a=netgr_corrected_compiled%&gt;%filter(!experiment%in%&quot;M3&quot;)%&gt;%mutate(sq_error=(netgr_model_m3-netgr_obs_corrected)^2)
mean(a$sq_error,na.rm=T)</code></pre>
<pre><code>[1] 5.662937e-05</code></pre>
<pre class="r"><code>b=netgr_corrected_compiled%&gt;%filter(!experiment%in%&quot;M3&quot;)%&gt;%mutate(sq_error=(netgr_model_m3-netgr_obs)^2)
mean(b$sq_error,na.rm=T)</code></pre>
<pre><code>[1] 0.0001524178</code></pre>
<pre class="r"><code>mean(b$sq_error,na.rm=T)/mean(a$sq_error,na.rm=T)</code></pre>
<pre><code>[1] 2.691497</code></pre>
<pre class="r"><code>####Making publication ready plots
netgr_corrected_compiled_forplot=melt(netgr_corrected_compiled,id.vars = c(&quot;mutant&quot;,&quot;experiment&quot;,&quot;netgr_model_m3&quot;,&quot;netgr_model_m4&quot;),measure.vars = c(&quot;netgr_obs&quot;,&quot;netgr_obs_corrected&quot;),variable.name = &quot;correction_status&quot;,value.name = &quot;netgr_obs&quot;)
# write.csv(netgr_corrected_compiled_forplot,&quot;twinstrand_microvariations_normalized.csv&quot;,row.names = F)

netgr_corrected_compiled_forplot=netgr_corrected_compiled_forplot%&gt;%
  filter(!experiment%in%&quot;M3&quot;)%&gt;%
  mutate(correction_status_name=
           case_when(correction_status==&quot;netgr_obs&quot;~&quot;Raw&quot;,
                     correction_status==&quot;netgr_obs_corrected&quot;~&quot;Corrected&quot;))
netgr_corrected_compiled_forplot$correction_status_name=factor(netgr_corrected_compiled_forplot$correction_status_name,levels=c(&quot;Raw&quot;,&quot;Corrected&quot;))

ggplot(netgr_corrected_compiled_forplot,aes(y=netgr_obs,x=netgr_model_m3))+
  geom_abline()+
  geom_point()+
  facet_wrap(~correction_status_name)+
  cleanup+
  scale_y_continuous(name=&quot;Growth rate of \n model replicate&quot;,limits=c(0,0.06))+
  scale_x_continuous(name=&quot;Growth rate of other replicates&quot;,limits=c(0,0.06))+
  theme(axis.text.x = element_text(size=11),
        axis.text.y = element_text(size=11),
        axis.title = element_text(size=11))</code></pre>
<pre><code>Warning: Removed 21 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-4-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-3">
Past versions of unnamed-chunk-4-3.png
</button>
</p>
<div id="fig-unnamed-chunk-4-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-4-3.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># ggsave(&quot;dosing_normalization_simple_e255k.pdf&quot;,width=5,height=3,units=&quot;in&quot;,useDingbats=F)

ggplot(netgr_corrected_compiled_forplot,aes(x=netgr_model_m3,y=netgr_obs,color=correction_status_name))+geom_abline()+geom_point()+facet_wrap(~experiment)+cleanup</code></pre>
<pre><code>Warning: Removed 18 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-4-4.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-4">
Past versions of unnamed-chunk-4-4.png
</button>
</p>
<div id="fig-unnamed-chunk-4-4" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-4-4.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ggplot(netgr_corrected_compiled_forplot%&gt;%filter(experiment%in%c(&quot;M3&quot;,&quot;M5&quot;)),aes(x=netgr_model_m3,y=netgr_obs,color=correction_status_name))+geom_abline()+geom_point(color=&quot;black&quot;,shape=21,size=2,aes(fill=correction_status_name))+cleanup+scale_x_continuous(name=&quot;Replicate 1&quot;,limits=c(0,.06))+scale_y_continuous(name=&quot;Replicate 2&quot;,limits=c(0,.06))+scale_fill_manual(values = c(&quot;black&quot;,&quot;gray90&quot;))+theme(legend.position = &quot;none&quot;,axis.text = element_blank(),axis.ticks = element_blank())</code></pre>
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-4-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># ggsave(&quot;r1r2_1in3000.pdf&quot;,width = 2,height=2,units=&quot;in&quot;,useDingbats=F)

ggplot(netgr_corrected_compiled_forplot%&gt;%filter(experiment%in%c(&quot;M3&quot;,&quot;M7&quot;)),aes(x=netgr_model_m3,y=netgr_obs,color=correction_status_name))+geom_abline()+geom_point(color=&quot;black&quot;,shape=21,size=2,aes(fill=correction_status_name))+cleanup+scale_x_continuous(name=&quot;Replicate 1&quot;,limits=c(0,.06))+scale_y_continuous(name=&quot;Replicate 3&quot;,limits=c(0,.06))+scale_fill_manual(values = c(&quot;black&quot;,&quot;gray90&quot;))+theme(legend.position = &quot;none&quot;,axis.text = element_blank(),axis.ticks = element_blank())</code></pre>
<pre><code>Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-4-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># ggsave(&quot;r1r3_1in3000.pdf&quot;,width = 2,height=2,units=&quot;in&quot;,useDingbats=F)

ggplot(netgr_corrected_compiled_forplot%&gt;%filter(experiment%in%c(&quot;M3&quot;,&quot;M6&quot;)),aes(x=netgr_model_m3,y=netgr_obs,color=correction_status_name))+geom_abline()+geom_point(color=&quot;black&quot;,shape=21,size=2,aes(fill=correction_status_name))+cleanup+scale_x_continuous(name=&quot;Replicate 1&quot;,limits=c(0,.06))+scale_y_continuous(name=&quot;Replicate 2&quot;,limits=c(0,.06))+scale_fill_manual(values = c(&quot;black&quot;,&quot;gray90&quot;))+theme(legend.position = &quot;none&quot;,axis.text = element_blank(),axis.ticks = element_blank())</code></pre>
<pre><code>Warning: Removed 5 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-4-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># ggsave(&quot;r1r2_1in5000.pdf&quot;,width = 2,height=2,units=&quot;in&quot;,useDingbats=F)


# netgr_corrected_compiled_forplot=netgr_corrected_compiled_forplot%&gt;%dplyr::select(mutant,experiment,correction_status,netgr_obs)</code></pre>
</div>
<div id="method-2-using-mcmc-we-decided-on-the-apparent-dose-of-mutants-based-on-the-net-growth-rates-of-4-standards-we-used-t315i-l248v-y253f-and-f359v.-with-the-apparent-doses-for-all-the-replicates-we-normalize-their-growth-rates-to-the-same-apparent-dose" class="section level4">
<h4>Method 2: Using MCMC, we decided on the apparent dose of mutants based on the net growth rates of 4 standards (we used T315I, L248V, Y253F, and F359V). With the apparent doses for all the replicates, we normalize their growth rates to the same apparent dose</h4>
<pre class="r"><code>###Outputs of MCMC code
mcmc_apparent_doses=data.frame(rbind(c(&quot;M3&quot;,0.9159),c(&quot;M4&quot;,1.4261),c(&quot;M5&quot;,1.4541),c(&quot;M6&quot;,1.35),c(&quot;M7&quot;,1.345)))
mcmc_apparent_doses=mcmc_apparent_doses%&gt;%dplyr::select(experiment=X1,dose_app=X2)

# source(&quot;../code/microvariation.normalizer.R&quot;)
source(&quot;code/microvariation.normalizer.R&quot;)

#Focusing on the non-ENU experiments
twinstrand_simple_melt_merge=twinstrand_simple_melt_merge%&gt;%filter(!experiment%in%c(&quot;Enu_3&quot;,&quot;Enu_4&quot;))
net_gr_wodrug=0.055
time=72
hill_standard=2.83 #E255K Hill
ic50_standard=1.205 #E255K IC50
standard_name=&quot;E255K&quot;
dose_model=0.9159 #M3 dose

netgr_corrected_compiled=data.frame()
dose_apparent_compiled=data.frame()
for(experiment_current in unique(twinstrand_simple_melt_merge$experiment)){
  netgr_raw=twinstrand_simple_melt_merge%&gt;%
    filter(experiment==experiment_current,duration==&quot;d3d6&quot;)%&gt;%
    dplyr::select(experiment,mutant,netgr_obs)
  
  ###For one experiment###
  netgr_corrected_experiment=microvariation.normalizer(netgr_raw,
                                     net_gr_wodrug,
                                     hill_standard,
                                     ic50_standard,
                                     dose_model,
                                     time,
                                     standard_name,
                                     mcmc=TRUE,
                                     dose_app_mcmc=as.numeric(mcmc_apparent_doses%&gt;%filter(experiment%in%experiment_current)%&gt;%dplyr::select(dose_app)))[[1]]
  #Dose apparent
  dose_apparent_experiment=microvariation.normalizer(netgr_raw,
                                     net_gr_wodrug,
                                     hill_standard,
                                     ic50_standard,
                                     dose_model,
                                     time,
                                     standard_name,
                                     mcmc=TRUE,
                                     dose_app_mcmc=as.numeric(mcmc_apparent_doses%&gt;%filter(experiment%in%experiment_current)%&gt;%dplyr::select(dose_app)))[[2]]

  netgr_corrected_compiled=rbind(netgr_corrected_experiment,netgr_corrected_compiled) #Of course faster way would be pre-allocating for efficiency
  dose_apparent_compiled=rbind(c(experiment_current,dose_apparent_experiment),dose_apparent_compiled)
}
#adding m3&#39;s growth rates as the model
netgr_corrected_compiled=merge(netgr_corrected_compiled,netgr_corrected_compiled%&gt;%filter(experiment%in%&quot;M3&quot;)%&gt;%dplyr::select(mutant,netgr_model_m3=netgr_obs),by=&quot;mutant&quot;)

plotly=ggplot(netgr_corrected_compiled,aes(x=netgr_model_m3,y=netgr_obs,color=experiment))+geom_point()+geom_abline()
ggplotly(plotly)</code></pre>
<div id="htmlwidget-e3d628f7474a9bbd5058" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e3d628f7474a9bbd5058">{"x":{"data":[{"x":[null,0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[null,0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"text":["netgr_model_m3:          NA<br />netgr_obs:            NA<br />experiment: M3","netgr_model_m3: 0.033480974<br />netgr_obs:  0.0334809739<br />experiment: M3","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M3","netgr_model_m3: 0.012731599<br />netgr_obs:  0.0127315991<br />experiment: M3","netgr_model_m3: 0.026790277<br />netgr_obs:  0.0267902770<br />experiment: M3","netgr_model_m3: 0.007921977<br />netgr_obs:  0.0079219772<br />experiment: M3","netgr_model_m3: 0.030804189<br />netgr_obs:  0.0308041893<br />experiment: M3","netgr_model_m3: 0.027673957<br />netgr_obs:  0.0276739573<br />experiment: M3","netgr_model_m3:          NA<br />netgr_obs:            NA<br />experiment: M3","netgr_model_m3: 0.028451269<br />netgr_obs:  0.0284512687<br />experiment: M3","netgr_model_m3: 0.051719608<br />netgr_obs:  0.0517196077<br />experiment: M3","netgr_model_m3: 0.048724323<br />netgr_obs:  0.0487243231<br />experiment: M3","netgr_model_m3: 0.042719864<br />netgr_obs:  0.0427198644<br />experiment: M3","netgr_model_m3: 0.039640627<br />netgr_obs:  0.0396406267<br />experiment: M3","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M3","netgr_model_m3: 0.035031039<br />netgr_obs:  0.0350310393<br />experiment: M3","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M3","netgr_model_m3: 0.046938345<br />netgr_obs:  0.0469383451<br />experiment: M3","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M3","netgr_model_m3: 0.044171597<br />netgr_obs:  0.0441715969<br />experiment: M3"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"M3","legendgroup":"M3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[0.0310994307754623,0.0549,0.000739116852729229,0.0128916576093964,0.0119926264309184,0.0140740544933049,0.0185405373776214,null,0.0319261652555624,0.0501433491660108,0.0378978239950472,0.0365771742828268,0.0309686188981078,0.0517805755748803,0.0183321277910253,0.0549,0.0336183747514546,0.0549,null],"text":["netgr_model_m3: 0.033480974<br />netgr_obs:  0.0310994308<br />experiment: M4","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M4","netgr_model_m3: 0.012731599<br />netgr_obs:  0.0007391169<br />experiment: M4","netgr_model_m3: 0.026790277<br />netgr_obs:  0.0128916576<br />experiment: M4","netgr_model_m3: 0.007921977<br />netgr_obs:  0.0119926264<br />experiment: M4","netgr_model_m3: 0.030804189<br />netgr_obs:  0.0140740545<br />experiment: M4","netgr_model_m3: 0.027673957<br />netgr_obs:  0.0185405374<br />experiment: M4","netgr_model_m3:          NA<br />netgr_obs:            NA<br />experiment: M4","netgr_model_m3: 0.028451269<br />netgr_obs:  0.0319261653<br />experiment: M4","netgr_model_m3: 0.051719608<br />netgr_obs:  0.0501433492<br />experiment: M4","netgr_model_m3: 0.048724323<br />netgr_obs:  0.0378978240<br />experiment: M4","netgr_model_m3: 0.042719864<br />netgr_obs:  0.0365771743<br />experiment: M4","netgr_model_m3: 0.039640627<br />netgr_obs:  0.0309686189<br />experiment: M4","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0517805756<br />experiment: M4","netgr_model_m3: 0.035031039<br />netgr_obs:  0.0183321278<br />experiment: M4","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M4","netgr_model_m3: 0.046938345<br />netgr_obs:  0.0336183748<br />experiment: M4","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M4","netgr_model_m3: 0.044171597<br />netgr_obs:            NA<br />experiment: M4"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"hoveron":"points","name":"M4","legendgroup":"M4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[0.018454112899826,0.0420585991056577,0.000184063148507012,0.00378404910423811,0.0154217487866259,0.0157697540124068,-0.00131177652732138,null,0.012149502478388,0.0375950168128817,0.0318396979860822,0.0323473649519127,0.0281485278643909,0.0413809616989955,0.0195654134351078,0.0431633699185258,0.0299196444387935,0.0426865554238963,null],"text":["netgr_model_m3: 0.033480974<br />netgr_obs:  0.0184541129<br />experiment: M5","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0420585991<br />experiment: M5","netgr_model_m3: 0.012731599<br />netgr_obs:  0.0001840631<br />experiment: M5","netgr_model_m3: 0.026790277<br />netgr_obs:  0.0037840491<br />experiment: M5","netgr_model_m3: 0.007921977<br />netgr_obs:  0.0154217488<br />experiment: M5","netgr_model_m3: 0.030804189<br />netgr_obs:  0.0157697540<br />experiment: M5","netgr_model_m3: 0.027673957<br />netgr_obs: -0.0013117765<br />experiment: M5","netgr_model_m3:          NA<br />netgr_obs:            NA<br />experiment: M5","netgr_model_m3: 0.028451269<br />netgr_obs:  0.0121495025<br />experiment: M5","netgr_model_m3: 0.051719608<br />netgr_obs:  0.0375950168<br />experiment: M5","netgr_model_m3: 0.048724323<br />netgr_obs:  0.0318396980<br />experiment: M5","netgr_model_m3: 0.042719864<br />netgr_obs:  0.0323473650<br />experiment: M5","netgr_model_m3: 0.039640627<br />netgr_obs:  0.0281485279<br />experiment: M5","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0413809617<br />experiment: M5","netgr_model_m3: 0.035031039<br />netgr_obs:  0.0195654134<br />experiment: M5","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0431633699<br />experiment: M5","netgr_model_m3: 0.046938345<br />netgr_obs:  0.0299196444<br />experiment: M5","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0426865554<br />experiment: M5","netgr_model_m3: 0.044171597<br />netgr_obs:            NA<br />experiment: M5"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"hoveron":"points","name":"M5","legendgroup":"M5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[0.0223612985762536,0.0549,null,0.0118278860192327,-0.00721304443411948,0.0160500200244016,0.000317413310529148,null,0.0297729630991121,0.0511485233285775,0.0407904899805769,0.0417233554390856,0.0302288352512854,0.0504638392474484,0.0222071460834166,0.0549,0.0382051517146049,0.0549,0.0294304233077991],"text":["netgr_model_m3: 0.033480974<br />netgr_obs:  0.0223612986<br />experiment: M6","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M6","netgr_model_m3: 0.012731599<br />netgr_obs:            NA<br />experiment: M6","netgr_model_m3: 0.026790277<br />netgr_obs:  0.0118278860<br />experiment: M6","netgr_model_m3: 0.007921977<br />netgr_obs: -0.0072130444<br />experiment: M6","netgr_model_m3: 0.030804189<br />netgr_obs:  0.0160500200<br />experiment: M6","netgr_model_m3: 0.027673957<br />netgr_obs:  0.0003174133<br />experiment: M6","netgr_model_m3:          NA<br />netgr_obs:            NA<br />experiment: M6","netgr_model_m3: 0.028451269<br />netgr_obs:  0.0297729631<br />experiment: M6","netgr_model_m3: 0.051719608<br />netgr_obs:  0.0511485233<br />experiment: M6","netgr_model_m3: 0.048724323<br />netgr_obs:  0.0407904900<br />experiment: M6","netgr_model_m3: 0.042719864<br />netgr_obs:  0.0417233554<br />experiment: M6","netgr_model_m3: 0.039640627<br />netgr_obs:  0.0302288353<br />experiment: M6","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0504638392<br />experiment: M6","netgr_model_m3: 0.035031039<br />netgr_obs:  0.0222071461<br />experiment: M6","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M6","netgr_model_m3: 0.046938345<br />netgr_obs:  0.0382051517<br />experiment: M6","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0549000000<br />experiment: M6","netgr_model_m3: 0.044171597<br />netgr_obs:  0.0294304233<br />experiment: M6"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"hoveron":"points","name":"M6","legendgroup":"M6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[0.0273175236817737,0.0521537397342698,null,-0.00629905685449964,0.0244149447014492,0.0175466585203488,0.0133176750947091,null,0.0245087972988564,0.0471097526960482,0.0361782186753564,0.0441999457380923,0.0269192923087508,0.048565238848959,0.026188301691051,0.0512023868232599,0.0355397221781819,0.0539402361362578,null],"text":["netgr_model_m3: 0.033480974<br />netgr_obs:  0.0273175237<br />experiment: M7","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0521537397<br />experiment: M7","netgr_model_m3: 0.012731599<br />netgr_obs:            NA<br />experiment: M7","netgr_model_m3: 0.026790277<br />netgr_obs: -0.0062990569<br />experiment: M7","netgr_model_m3: 0.007921977<br />netgr_obs:  0.0244149447<br />experiment: M7","netgr_model_m3: 0.030804189<br />netgr_obs:  0.0175466585<br />experiment: M7","netgr_model_m3: 0.027673957<br />netgr_obs:  0.0133176751<br />experiment: M7","netgr_model_m3:          NA<br />netgr_obs:            NA<br />experiment: M7","netgr_model_m3: 0.028451269<br />netgr_obs:  0.0245087973<br />experiment: M7","netgr_model_m3: 0.051719608<br />netgr_obs:  0.0471097527<br />experiment: M7","netgr_model_m3: 0.048724323<br />netgr_obs:  0.0361782187<br />experiment: M7","netgr_model_m3: 0.042719864<br />netgr_obs:  0.0441999457<br />experiment: M7","netgr_model_m3: 0.039640627<br />netgr_obs:  0.0269192923<br />experiment: M7","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0485652388<br />experiment: M7","netgr_model_m3: 0.035031039<br />netgr_obs:  0.0261883017<br />experiment: M7","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0512023868<br />experiment: M7","netgr_model_m3: 0.046938345<br />netgr_obs:  0.0355397222<br />experiment: M7","netgr_model_m3: 0.054900000<br />netgr_obs:  0.0539402361<br />experiment: M7","netgr_model_m3: 0.044171597<br />netgr_obs:            NA<br />experiment: M7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"hoveron":"points","name":"M7","legendgroup":"M7","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.00557307603104774,0.0572489011413787],"y":[0.00557307603104774,0.0572489011413787],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.00557307603104774,0.0572489011413787],"tickmode":"array","ticktext":["0.01","0.02","0.03","0.04","0.05"],"tickvals":[0.01,0.02,0.03,0.04,0.05],"categoryorder":"array","categoryarray":["0.01","0.02","0.03","0.04","0.05"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"netgr_model_m3","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0103186966558255,0.058005652221706],"tickmode":"array","ticktext":["0.00","0.02","0.04"],"tickvals":[0,0.02,0.04],"categoryorder":"array","categoryarray":["0.00","0.02","0.04"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"netgr_obs","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"experiment","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"15887540da7d":{"x":{},"y":{},"colour":{},"type":"scatter"},"158874c880ae":{"intercept":{},"slope":{}}},"cur_data":"15887540da7d","visdat":{"15887540da7d":["function (y) ","x"],"158874c880ae":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>plotly=ggplot(netgr_corrected_compiled,aes(x=netgr_model_m3,y=netgr_obs_corrected,color=experiment))+geom_point()+geom_abline()
ggplotly(plotly)</code></pre>
<div id="htmlwidget-008ac7ee89cb37500d77" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-008ac7ee89cb37500d77">{"x":{"data":[{"x":[null,0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[null,0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"text":["netgr_model_m3:          NA<br />netgr_obs_corrected:          NA<br />experiment: M3","netgr_model_m3: 0.033480974<br />netgr_obs_corrected: 0.033480974<br />experiment: M3","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054900000<br />experiment: M3","netgr_model_m3: 0.012731599<br />netgr_obs_corrected: 0.012731599<br />experiment: M3","netgr_model_m3: 0.026790277<br />netgr_obs_corrected: 0.026790277<br />experiment: M3","netgr_model_m3: 0.007921977<br />netgr_obs_corrected: 0.007921977<br />experiment: M3","netgr_model_m3: 0.030804189<br />netgr_obs_corrected: 0.030804189<br />experiment: M3","netgr_model_m3: 0.027673957<br />netgr_obs_corrected: 0.027673957<br />experiment: M3","netgr_model_m3:          NA<br />netgr_obs_corrected:          NA<br />experiment: M3","netgr_model_m3: 0.028451269<br />netgr_obs_corrected: 0.028451269<br />experiment: M3","netgr_model_m3: 0.051719608<br />netgr_obs_corrected: 0.051719608<br />experiment: M3","netgr_model_m3: 0.048724323<br />netgr_obs_corrected: 0.048724323<br />experiment: M3","netgr_model_m3: 0.042719864<br />netgr_obs_corrected: 0.042719864<br />experiment: M3","netgr_model_m3: 0.039640627<br />netgr_obs_corrected: 0.039640627<br />experiment: M3","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054900000<br />experiment: M3","netgr_model_m3: 0.035031039<br />netgr_obs_corrected: 0.035031039<br />experiment: M3","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054900000<br />experiment: M3","netgr_model_m3: 0.046938345<br />netgr_obs_corrected: 0.046938345<br />experiment: M3","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054900000<br />experiment: M3","netgr_model_m3: 0.044171597<br />netgr_obs_corrected: 0.044171597<br />experiment: M3"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"M3","legendgroup":"M3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[0.0433669586021373,0.0549713646705999,0.0174618554103176,0.0287140212227536,0.02790901707718,0.0297641970066544,0.0336321270710744,null,0.0439328104148478,0.0534314095489775,0.0476885101230715,0.0469099324068804,0.0432764563018624,0.054001905167953,0.0334554814009053,0.0549713646705999,0.0450572902416406,0.0549713646705999,null],"text":["netgr_model_m3: 0.033480974<br />netgr_obs_corrected: 0.043366959<br />experiment: M4","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054971365<br />experiment: M4","netgr_model_m3: 0.012731599<br />netgr_obs_corrected: 0.017461855<br />experiment: M4","netgr_model_m3: 0.026790277<br />netgr_obs_corrected: 0.028714021<br />experiment: M4","netgr_model_m3: 0.007921977<br />netgr_obs_corrected: 0.027909017<br />experiment: M4","netgr_model_m3: 0.030804189<br />netgr_obs_corrected: 0.029764197<br />experiment: M4","netgr_model_m3: 0.027673957<br />netgr_obs_corrected: 0.033632127<br />experiment: M4","netgr_model_m3:          NA<br />netgr_obs_corrected:          NA<br />experiment: M4","netgr_model_m3: 0.028451269<br />netgr_obs_corrected: 0.043932810<br />experiment: M4","netgr_model_m3: 0.051719608<br />netgr_obs_corrected: 0.053431410<br />experiment: M4","netgr_model_m3: 0.048724323<br />netgr_obs_corrected: 0.047688510<br />experiment: M4","netgr_model_m3: 0.042719864<br />netgr_obs_corrected: 0.046909932<br />experiment: M4","netgr_model_m3: 0.039640627<br />netgr_obs_corrected: 0.043276456<br />experiment: M4","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054001905<br />experiment: M4","netgr_model_m3: 0.035031039<br />netgr_obs_corrected: 0.033455481<br />experiment: M4","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054971365<br />experiment: M4","netgr_model_m3: 0.046938345<br />netgr_obs_corrected: 0.045057290<br />experiment: M4","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054971365<br />experiment: M4","netgr_model_m3: 0.044171597<br />netgr_obs_corrected:          NA<br />experiment: M4"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)"}},"hoveron":"points","name":"M4","legendgroup":"M4","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[0.0341563752550269,0.0501685586597282,0.0176465270634501,0.0210443272013026,0.0315744358046494,0.0318749157367153,0.0162211444579931,null,0.0287017212173892,0.0478260628830254,0.044290129669978,0.0446243899228206,0.0417383243694304,0.049835971882529,0.0350807105369217,0.0506930872862986,0.042988829399993,0.0504693903975471,null],"text":["netgr_model_m3: 0.033480974<br />netgr_obs_corrected: 0.034156375<br />experiment: M5","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.050168559<br />experiment: M5","netgr_model_m3: 0.012731599<br />netgr_obs_corrected: 0.017646527<br />experiment: M5","netgr_model_m3: 0.026790277<br />netgr_obs_corrected: 0.021044327<br />experiment: M5","netgr_model_m3: 0.007921977<br />netgr_obs_corrected: 0.031574436<br />experiment: M5","netgr_model_m3: 0.030804189<br />netgr_obs_corrected: 0.031874916<br />experiment: M5","netgr_model_m3: 0.027673957<br />netgr_obs_corrected: 0.016221144<br />experiment: M5","netgr_model_m3:          NA<br />netgr_obs_corrected:          NA<br />experiment: M5","netgr_model_m3: 0.028451269<br />netgr_obs_corrected: 0.028701721<br />experiment: M5","netgr_model_m3: 0.051719608<br />netgr_obs_corrected: 0.047826063<br />experiment: M5","netgr_model_m3: 0.048724323<br />netgr_obs_corrected: 0.044290130<br />experiment: M5","netgr_model_m3: 0.042719864<br />netgr_obs_corrected: 0.044624390<br />experiment: M5","netgr_model_m3: 0.039640627<br />netgr_obs_corrected: 0.041738324<br />experiment: M5","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.049835972<br />experiment: M5","netgr_model_m3: 0.035031039<br />netgr_obs_corrected: 0.035080711<br />experiment: M5","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.050693087<br />experiment: M5","netgr_model_m3: 0.046938345<br />netgr_obs_corrected: 0.042988829<br />experiment: M5","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.050469390<br />experiment: M5","netgr_model_m3: 0.044171597<br />netgr_obs_corrected:          NA<br />experiment: M5"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)"}},"hoveron":"points","name":"M5","legendgroup":"M5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[0.0351876876691475,0.0549665630264415,null,0.0258892185288887,0.00772447191041106,0.0297128297966253,0.0150351887637348,null,0.0411142726458039,0.0535931787393066,0.0485213873185396,0.0490566686978791,0.0414569624074912,0.0533167785960454,0.035058091686305,0.0549665630264415,0.0469588489236595,0.0549665630264415,0.0408549526624557],"text":["netgr_model_m3: 0.033480974<br />netgr_obs_corrected: 0.035187688<br />experiment: M6","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054966563<br />experiment: M6","netgr_model_m3: 0.012731599<br />netgr_obs_corrected:          NA<br />experiment: M6","netgr_model_m3: 0.026790277<br />netgr_obs_corrected: 0.025889219<br />experiment: M6","netgr_model_m3: 0.007921977<br />netgr_obs_corrected: 0.007724472<br />experiment: M6","netgr_model_m3: 0.030804189<br />netgr_obs_corrected: 0.029712830<br />experiment: M6","netgr_model_m3: 0.027673957<br />netgr_obs_corrected: 0.015035189<br />experiment: M6","netgr_model_m3:          NA<br />netgr_obs_corrected:          NA<br />experiment: M6","netgr_model_m3: 0.028451269<br />netgr_obs_corrected: 0.041114273<br />experiment: M6","netgr_model_m3: 0.051719608<br />netgr_obs_corrected: 0.053593179<br />experiment: M6","netgr_model_m3: 0.048724323<br />netgr_obs_corrected: 0.048521387<br />experiment: M6","netgr_model_m3: 0.042719864<br />netgr_obs_corrected: 0.049056669<br />experiment: M6","netgr_model_m3: 0.039640627<br />netgr_obs_corrected: 0.041456962<br />experiment: M6","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.053316779<br />experiment: M6","netgr_model_m3: 0.035031039<br />netgr_obs_corrected: 0.035058092<br />experiment: M6","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054966563<br />experiment: M6","netgr_model_m3: 0.046938345<br />netgr_obs_corrected: 0.046958849<br />experiment: M6","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054966563<br />experiment: M6","netgr_model_m3: 0.044171597<br />netgr_obs_corrected: 0.040854953<br />experiment: M6"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)"}},"hoveron":"points","name":"M6","legendgroup":"M6","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0334809738680772,0.0549,0.012731599110772,0.0267902770166541,0.00792197717242642,0.0308041892913613,0.0276739573164411,null,0.028451268722294,0.0517196077013197,0.0487243231157813,0.0427198643829193,0.0396406266927503,0.0549,0.0350310392612771,0.0549,0.0469383450557703,0.0549,0.0441715968666497],"y":[0.0391228210566739,0.0539740155337398,null,0.00847684222988123,0.036785157611964,0.030920012363337,0.0271245870291992,null,0.0368622011823203,0.0518139181106439,0.0455832382221944,0.0503615134448218,0.0388078067461679,0.0524833660288344,0.0382247205356591,0.0536006666536595,0.045156342923898,0.0546336559420277,null],"text":["netgr_model_m3: 0.033480974<br />netgr_obs_corrected: 0.039122821<br />experiment: M7","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.053974016<br />experiment: M7","netgr_model_m3: 0.012731599<br />netgr_obs_corrected:          NA<br />experiment: M7","netgr_model_m3: 0.026790277<br />netgr_obs_corrected: 0.008476842<br />experiment: M7","netgr_model_m3: 0.007921977<br />netgr_obs_corrected: 0.036785158<br />experiment: M7","netgr_model_m3: 0.030804189<br />netgr_obs_corrected: 0.030920012<br />experiment: M7","netgr_model_m3: 0.027673957<br />netgr_obs_corrected: 0.027124587<br />experiment: M7","netgr_model_m3:          NA<br />netgr_obs_corrected:          NA<br />experiment: M7","netgr_model_m3: 0.028451269<br />netgr_obs_corrected: 0.036862201<br />experiment: M7","netgr_model_m3: 0.051719608<br />netgr_obs_corrected: 0.051813918<br />experiment: M7","netgr_model_m3: 0.048724323<br />netgr_obs_corrected: 0.045583238<br />experiment: M7","netgr_model_m3: 0.042719864<br />netgr_obs_corrected: 0.050361513<br />experiment: M7","netgr_model_m3: 0.039640627<br />netgr_obs_corrected: 0.038807807<br />experiment: M7","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.052483366<br />experiment: M7","netgr_model_m3: 0.035031039<br />netgr_obs_corrected: 0.038224721<br />experiment: M7","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.053600667<br />experiment: M7","netgr_model_m3: 0.046938345<br />netgr_obs_corrected: 0.045156343<br />experiment: M7","netgr_model_m3: 0.054900000<br />netgr_obs_corrected: 0.054633656<br />experiment: M7","netgr_model_m3: 0.044171597<br />netgr_obs_corrected:          NA<br />experiment: M7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)"}},"hoveron":"points","name":"M7","legendgroup":"M7","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.00557307603104774,0.0572489011413787],"y":[0.00557307603104774,0.0572489011413787],"text":"intercept: 0<br />slope: 1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":48.9497716894977},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.00557307603104774,0.0572489011413787],"tickmode":"array","ticktext":["0.01","0.02","0.03","0.04","0.05"],"tickvals":[0.01,0.02,0.03,0.04,0.05],"categoryorder":"array","categoryarray":["0.01","0.02","0.03","0.04","0.05"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"netgr_model_m3","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.00536212727240162,0.0573337093086093],"tickmode":"array","ticktext":["0.01","0.02","0.03","0.04","0.05"],"tickvals":[0.01,0.02,0.03,0.04,0.05],"categoryorder":"array","categoryarray":["0.01","0.02","0.03","0.04","0.05"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"netgr_obs_corrected","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"annotations":[{"text":"experiment","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"15882b834d7a":{"x":{},"y":{},"colour":{},"type":"scatter"},"158839539ae7":{"intercept":{},"slope":{}}},"cur_data":"15882b834d7a","visdat":{"15882b834d7a":["function (y) ","x"],"158839539ae7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>####Calculating mean squared error
a=netgr_corrected_compiled%&gt;%filter(!experiment%in%&quot;M3&quot;)%&gt;%mutate(sq_error=(netgr_model_m3-netgr_obs_corrected)^2)
mean(a$sq_error,na.rm=T)</code></pre>
<pre><code>[1] 5.197234e-05</code></pre>
<pre class="r"><code>b=netgr_corrected_compiled%&gt;%filter(!experiment%in%&quot;M3&quot;)%&gt;%mutate(sq_error=(netgr_model_m3-netgr_obs)^2)
mean(b$sq_error,na.rm=T)</code></pre>
<pre><code>[1] 0.0001524178</code></pre>
<pre class="r"><code>mean(b$sq_error,na.rm=T)/mean(a$sq_error,na.rm=T)</code></pre>
<pre><code>[1] 2.932671</code></pre>
<pre class="r"><code>####Making publication ready plots
netgr_corrected_compiled_forplot=melt(netgr_corrected_compiled,id.vars = c(&quot;mutant&quot;,&quot;experiment&quot;,&quot;netgr_model_m3&quot;),measure.vars = c(&quot;netgr_obs&quot;,&quot;netgr_obs_corrected&quot;),variable.name = &quot;correction_status&quot;,value.name = &quot;netgr_obs&quot;)
netgr_corrected_compiled_forplot=netgr_corrected_compiled_forplot%&gt;%
  filter(!experiment%in%&quot;M3&quot;)%&gt;%
  mutate(correction_status_name=
           case_when(correction_status==&quot;netgr_obs&quot;~&quot;Raw&quot;,
                     correction_status==&quot;netgr_obs_corrected&quot;~&quot;Corrected&quot;))
netgr_corrected_compiled_forplot$correction_status_name=factor(netgr_corrected_compiled_forplot$correction_status_name,levels=c(&quot;Raw&quot;,&quot;Corrected&quot;))

ggplot(netgr_corrected_compiled_forplot,aes(y=netgr_obs,x=netgr_model_m3))+
  geom_abline()+
  geom_point()+
  facet_wrap(~correction_status_name)+
  cleanup+
  scale_y_continuous(name=&quot;Growth rate of \n model replicate&quot;,limits=c(0,0.06))+
  scale_x_continuous(name=&quot;Growth rate of other replicates&quot;,limits=c(0,0.06))+
  theme(axis.text.x = element_text(size=11),
        axis.text.y = element_text(size=11),
        axis.title = element_text(size=11))</code></pre>
<pre><code>Warning: Removed 21 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-5-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-3">
Past versions of unnamed-chunk-5-3.png
</button>
</p>
<div id="fig-unnamed-chunk-5-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-5-3.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code># ggsave(&quot;dosing_normalization_simple_mcmc.pdf&quot;,width=5,height=3,units=&quot;in&quot;,useDingbats=F)

ggplot(netgr_corrected_compiled_forplot,aes(x=netgr_model_m3,y=netgr_obs,color=correction_status_name))+geom_abline()+geom_point()+facet_wrap(~experiment)+cleanup</code></pre>
<pre><code>Warning: Removed 18 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-5-4.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-4">
Past versions of unnamed-chunk-5-4.png
</button>
</p>
<div id="fig-unnamed-chunk-5-4" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/haiderinam/duplex_sequencing_screen/blob/da11e69bcad09ab2dd9349c7412b988b3ccf5f97/docs/figure/dosing_normalization.Rmd/unnamed-chunk-5-4.png" target="_blank">da11e69</a>
</td>
<td>
haiderinam
</td>
<td>
2020-06-30
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>###Part 4: Correcting ENU replicates #### We will use Method 2 MCMC method: Use the apparent dose of the standard (E255K in this case) to normalize the growth rates of the other mutants to the same apparent dose</p>
<pre class="r"><code>rm(list=ls())
cleanup=theme_bw() +
  theme(plot.title = element_text(hjust=.5),
        panel.grid.major = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.background = element_blank(),
        axis.line = element_line(color = &quot;black&quot;),
        axis.text = element_text(face=&quot;bold&quot;,color=&quot;black&quot;,size=&quot;11&quot;),
        text=element_text(size=11,face=&quot;bold&quot;),
        axis.title=element_text(face=&quot;bold&quot;,size=&quot;11&quot;))
conc_for_predictions=0.8
net_gr_wodrug=.055
# twinstrand_maf_merge=read.csv(&quot;../output/twinstrand_maf_merge.csv&quot;,header = T,stringsAsFactors = F)
twinstrand_maf_merge=read.csv(&quot;output/twinstrand_maf_merge.csv&quot;,header = T,stringsAsFactors = F)

# ic50data_long=read.csv(&quot;../output/ic50data_all_conc.csv&quot;,header = T,stringsAsFactors = F,row.names=1)
ic50data_long=read.csv(&quot;output/ic50data_all_conc.csv&quot;,header = T,stringsAsFactors = F,row.names=1)
################Remaking Twinstrand Simple Melt Merge################
twinstrand_simple=twinstrand_maf_merge%&gt;%filter(!is.na(mutant),!is.na(experiment))
twinstrand_simple=twinstrand_simple%&gt;%dplyr::select(&quot;mutant&quot;,&quot;experiment&quot;,&quot;Spike_in_freq&quot;,&quot;time_point&quot;,&quot;totalmutant&quot;)
###Inferring Enu_4 D0 total mutants to be the same as Enu_3 D0 totals
  twinstrand_simple_enu4d0=twinstrand_simple%&gt;%filter(experiment==&quot;Enu_4&quot;,time_point==&quot;D0&quot;)%&gt;%mutate(experiment=&quot;Enu_3&quot;)
  twinstrand_simple=rbind(twinstrand_simple,twinstrand_simple_enu4d0)
twinstrand_simple_cast=dcast(twinstrand_simple,mutant+experiment+Spike_in_freq~time_point,value.var=&quot;totalmutant&quot;)

twinstrand_simple_cast$d0d3=log(twinstrand_simple_cast$D3/twinstrand_simple_cast$D0)/72
twinstrand_simple_cast$d3d6=log(twinstrand_simple_cast$D6/twinstrand_simple_cast$D3)/72
twinstrand_simple_cast$d0d6=log(twinstrand_simple_cast$D6/twinstrand_simple_cast$D0)/144

# twinstrand_simple_cast2=twinstrand_simple_cast%&gt;%group_by(mutant)%&gt;%mutate(case_when(D0=experiment==&quot;Enu_3&quot;~D0[experiment==&quot;Enu_4&quot;]))
#Check if ln(final/initial)/time is the correct formula. Also notice how I&#39;m using days not hours
twinstrand_simple_melt=melt(twinstrand_simple_cast[,-c(4:6)],id.vars=c(&quot;mutant&quot;,&quot;experiment&quot;,&quot;Spike_in_freq&quot;),variable.name = &quot;duration&quot;,value.name = &quot;netgr_obs&quot;) #!!!!!!!!!!!value name should be drug effect. And drug effect should be drug_effect_obs i think. NO. I think this should be drug_effect_obs. Fixed 4/2/20
twinstrand_simple_melt$drug_effect_obs=net_gr_wodrug-twinstrand_simple_melt$netgr_obs

# twinstrand_simple_melt_merge=merge(twinstrand_simple_melt,ic50data_formerge,&quot;mutant&quot;)
twinstrand_simple_melt_merge=merge(twinstrand_simple_melt,ic50data_long%&gt;%filter(conc==conc_for_predictions),all.x = T)



# a=twinstrand_simple_melt%&gt;%filter(experiment%in%&quot;Enu_3&quot;)
# a=twinstrand_simple_cast%&gt;%filter(experiment%in%&quot;Enu_3&quot;)
# a=twinstrand_maf_merge%&gt;%filter(experiment%in%&quot;Enu_3&quot;,time_point==&quot;D3&quot;)
#########################

####Plotting replicate 1 vs replicate 2 in two ways.
#1. Use only replicates in which you have sufficient coverage for mutants on D6
#2. Instead of using D3 and D6 counts. Use D0 and D3 counts. Since you didn&#39;t have counts for ENU for D3, assume that counts for Enu_3 at D0 would have looked the same as ENU_4 at D0.
#One interesting thing that I noticed is that D0-D3 growth rates for ENU3 and 4 were alike However D3 to D6 growth rates were higher for Enu3 than Enu4. Is it possible you measured Enu3 late? Yes, it does look like you measured Enu3 at 144 hours vs ENU 3 at 133 hours which might be causing the increased apparent growth rate of ENU3

enu_plots=twinstrand_simple_melt_merge%&gt;%filter(experiment%in%c(&quot;Enu_4&quot;,&quot;Enu_3&quot;),duration%in%&quot;d3d6&quot;,!netgr_obs%in%NA)
#hardcoding adjustments to the growth rates
enu_plots$netgr_obs[enu_plots$experiment==&quot;Enu_3&quot;]=enu_plots$netgr_obs[enu_plots$experiment==&quot;Enu_3&quot;]

enu_cast=dcast(enu_plots,formula = mutant~experiment,value.var = &quot;netgr_obs&quot;)</code></pre>
<p>Using the dosing normalization function for ENU Caveat: Now we’re using L248V as a standard, and using d0d3 counts rather than d3d6 counts. Also assuming Enu_4 D0 counts were similar to Enu_3 D0 counts</p>
<pre class="r"><code># # rm(list=ls())
# cleanup=theme_bw() +
#   theme(plot.title = element_text(hjust=.5),
#         panel.grid.major = element_blank(),
#         panel.grid.major.y = element_blank(),
#         panel.background = element_blank(),
#         axis.line = element_line(color = &quot;black&quot;),
#         axis.text = element_text(face=&quot;bold&quot;,color=&quot;black&quot;,size=&quot;11&quot;),
#         text=element_text(size=11,face=&quot;bold&quot;),
#         axis.title=element_text(face=&quot;bold&quot;,size=&quot;11&quot;))
# twinstrand_simple_melt_merge=read.csv(&quot;../output/twinstrand_simple_melt_merge.csv&quot;,header = T,stringsAsFactors = F,row.names=1)
twinstrand_simple_melt_merge=read.csv(&quot;output/twinstrand_simple_melt_merge.csv&quot;,header = T,stringsAsFactors = F,row.names=1)
####First, we choose our model experiment and calculate the apparent dose at that model experiment using the net growth rate of the standard.
#Apparent dose of E255K (standard) for M3 (model experiment)
# ((1-exp((net_gr_wodrug-0.033481)*time))*-(ic50_standard^hill_standard))^(1/hill_standard)
#We will use this as the apparent dose for our model experiment. Will normalize all other experiments to this dose.

# source(&quot;../code/microvariation.normalizer.R&quot;)
source(&quot;code/microvariation.normalizer.R&quot;)

#Focusing on the ENU only experiments
twinstrand_simple_melt_merge=twinstrand_simple_melt_merge%&gt;%filter(!experiment%in%c(&quot;M3&quot;,&quot;M4&quot;,&quot;M5&quot;,&quot;M6&quot;,&quot;M7&quot;))
net_gr_wodrug=0.065
time=72
hill_standard=0.789 #E255K Hill
ic50_standard=2.325 #E255K IC50
standard_name=&quot;L248V&quot;
dose_model=3.694476 #M3 dose

netgr_corrected_compiled=data.frame()
dose_apparent_compiled=data.frame()
# experiment_current=&quot;Enu_3&quot;
for(experiment_current in unique(twinstrand_simple_melt_merge$experiment)){
  netgr_raw=twinstrand_simple_melt_merge%&gt;%
    filter(experiment==experiment_current,duration==&quot;d0d3&quot;)%&gt;%
    dplyr::select(experiment,mutant,netgr_obs)
  # netgr_raw=twinstrand_simple_melt_merge%&gt;%
  #   filter(experiment==experiment_current,duration==&quot;d3d6&quot;)%&gt;%
  #   dplyr::select(experiment,mutant,netgr_obs)
  
  
  
  
  ###For one experiment###
  netgr_corrected_experiment=microvariation.normalizer(netgr_raw,
                                     net_gr_wodrug,
                                     hill_standard,
                                     ic50_standard,
                                     dose_model,
                                     time,
                                     standard_name)[[1]]
  #Dose apparent
  dose_apparent_experiment=microvariation.normalizer(netgr_raw,
                                     net_gr_wodrug,
                                     hill_standard,
                                     ic50_standard,
                                     dose_model,
                                     time,
                                     standard_name)[[2]]

  netgr_corrected_compiled=rbind(netgr_corrected_experiment,netgr_corrected_compiled) #Of course faster way would be pre-allocating for efficiency
  dose_apparent_compiled=rbind(c(experiment_current,dose_apparent_experiment),dose_apparent_compiled)
}
#adding m3&#39;s growth rates as the model
netgr_corrected_compiled=merge(netgr_corrected_compiled,netgr_corrected_compiled%&gt;%filter(experiment%in%&quot;Enu_4&quot;)%&gt;%dplyr::select(mutant,netgr_model_m3=netgr_obs),by=&quot;mutant&quot;)

ggplot(netgr_corrected_compiled,aes(x=netgr_model_m3,y=netgr_obs,color=experiment))+geom_point()+geom_abline()</code></pre>
<pre><code>Warning: Removed 13 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(netgr_corrected_compiled,aes(x=netgr_model_m3,y=netgr_obs_corrected,color=experiment))+geom_point()+geom_abline()</code></pre>
<pre><code>Warning: Removed 13 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-7-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>###Looking at whether we can correct by mean growth rate for E255K
# netgr_model=netgr_corrected_compiled%&gt;%group_by(mutant)%&gt;%summarize(netgr_model=mean(netgr_obs,na.rm=T),netgr_model_corrected=mean(netgr_obs_corrected,na.rm=T))
# ggplot(netgr_model,aes(x=netgr_model,y=netgr_model_corrected))+geom_point()+geom_abline()
# a=merge(netgr_corrected_compiled,netgr_model,by=&quot;mutant&quot;)
# ggplot(a,aes(x=netgr_model,y=netgr_obs_corrected,color=experiment))+geom_point()+geom_abline()
# ggplot(a,aes(x=netgr_model_corrected,y=netgr_obs_corrected,color=experiment))+geom_point()+geom_abline()

#Problem right now: For stuff that has a growth rate higher than netgr_obs, how do you correct it? Because those things apparently have an infinite IC50    
####Calculating mean squared error
a=netgr_corrected_compiled%&gt;%filter(!experiment%in%&quot;Enu_4&quot;)%&gt;%mutate(sq_error=(netgr_model_m3-netgr_obs_corrected)^2)
mean(a$sq_error,na.rm=T)</code></pre>
<pre><code>[1] NaN</code></pre>
<pre class="r"><code>b=netgr_corrected_compiled%&gt;%filter(!experiment%in%&quot;Enu_4&quot;)%&gt;%mutate(sq_error=(netgr_model_m3-netgr_obs)^2)
mean(b$sq_error,na.rm=T)</code></pre>
<pre><code>[1] NaN</code></pre>
<pre class="r"><code>mean(b$sq_error,na.rm=T)/mean(a$sq_error,na.rm=T)</code></pre>
<pre><code>[1] NaN</code></pre>
<pre class="r"><code>####Making publication ready plots
netgr_corrected_compiled_forplot=melt(netgr_corrected_compiled,id.vars = c(&quot;mutant&quot;,&quot;experiment&quot;,&quot;netgr_model_m3&quot;),measure.vars = c(&quot;netgr_obs&quot;,&quot;netgr_obs_corrected&quot;),variable.name = &quot;correction_status&quot;,value.name = &quot;netgr_obs&quot;)
netgr_corrected_compiled_forplot=netgr_corrected_compiled_forplot%&gt;%
  filter(!experiment%in%&quot;Enu_4&quot;)%&gt;%
  mutate(correction_status_name=
           case_when(correction_status==&quot;netgr_obs&quot;~&quot;Raw&quot;,
                     correction_status==&quot;netgr_obs_corrected&quot;~&quot;Corrected&quot;))
netgr_corrected_compiled_forplot$correction_status_name=factor(netgr_corrected_compiled_forplot$correction_status_name,levels=c(&quot;Raw&quot;,&quot;Corrected&quot;))

ggplot(netgr_corrected_compiled_forplot,aes(y=netgr_obs,x=netgr_model_m3))+
  geom_abline()+
  geom_point()+
  facet_wrap(~correction_status_name)+
  cleanup+
  scale_y_continuous(name=&quot;Growth rate of \n model replicate&quot;,limits=c(0,0.068))+
  scale_x_continuous(name=&quot;Growth rate of other replicates&quot;,limits=c(0,0.068))+
  theme(axis.text.x = element_text(size=11),
        axis.text.y = element_text(size=11),
        axis.title = element_text(size=11))</code></pre>
<pre><code>Warning: Removed 22 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-7-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># ggsave(&quot;dosing_normalization_simple_e255k.pdf&quot;,width=5,height=3,units=&quot;in&quot;,useDingbats=F)

ggplot(netgr_corrected_compiled_forplot,aes(x=netgr_model_m3,y=netgr_obs,color=correction_status_name))+geom_abline()+geom_point()+facet_wrap(~experiment)+cleanup</code></pre>
<pre><code>Warning: Removed 22 rows containing missing values (geom_point).</code></pre>
<p><img src="figure/dosing_normalization.Rmd/unnamed-chunk-7-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># twinstrand_simple_melt_merge=read.csv(&quot;../output/twinstrand_simple_melt_merge.csv&quot;,header = T,stringsAsFactors = F,row.names=1)
twinstrand_simple_melt_merge=read.csv(&quot;output/twinstrand_simple_melt_merge.csv&quot;,header = T,stringsAsFactors = F,row.names=1)

a=twinstrand_simple_melt_merge%&gt;%
    filter(experiment%in%c(&quot;Enu_4&quot;,&quot;Enu_3&quot;))%&gt;%
    dplyr::select(experiment,duration,mutant,netgr_obs)
a=a%&gt;%filter(!(experiment%in%&quot;Enu_3&quot;&amp;duration%in%c(&quot;d0d6&quot;,&quot;d0d3&quot;)))</code></pre>
<p>To do: what if you used the actual hill coefficients of the mutants rather than E255K’s hill coefficient (2.83). Would the correlation improve? Would the simulations decrease in quality if you altered the E255K growth rates and tried to make corrections off of those? This is kind of like a negative control for corrections.</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.0 (2020-04-24)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Catalina 10.15.5

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] parallel  grid      stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] deSolve_1.28        boot_1.3-24         lme4_1.1-23        
 [4] Matrix_1.2-18       fitdistrplus_1.0-14 npsurv_0.4-0.1     
 [7] lsei_1.2-0.1        survival_3.1-12     lmtest_0.9-37      
[10] zoo_1.8-8           drc_3.0-1           MASS_7.3-51.5      
[13] BiocManager_1.30.10 plotly_4.9.2.1      ggsignif_0.6.0     
[16] devtools_2.3.0      usethis_1.6.1       RColorBrewer_1.1-2 
[19] reshape2_1.4.4      ggplot2_3.3.0       doParallel_1.0.15  
[22] iterators_1.0.12    foreach_1.5.0       dplyr_0.8.5        
[25] VennDiagram_1.6.20  futile.logger_1.4.3 tictoc_1.0         
[28] knitr_1.28          workflowr_1.6.2    

loaded via a namespace (and not attached):
 [1] TH.data_1.0-10       minqa_1.2.4          colorspace_1.4-1    
 [4] ellipsis_0.3.1       rio_0.5.16           rprojroot_1.3-2     
 [7] fs_1.4.1             farver_2.0.3         remotes_2.1.1       
[10] fansi_0.4.1          mvtnorm_1.1-0        codetools_0.2-16    
[13] splines_4.0.0        pkgload_1.0.2        jsonlite_1.6.1      
[16] nloptr_1.2.2.1       compiler_4.0.0       httr_1.4.1          
[19] backports_1.1.7      assertthat_0.2.1     lazyeval_0.2.2      
[22] cli_2.0.2            later_1.0.0          formatR_1.7         
[25] htmltools_0.4.0      prettyunits_1.1.1    tools_4.0.0         
[28] gtable_0.3.0         glue_1.4.1           Rcpp_1.0.4.6        
[31] carData_3.0-3        cellranger_1.1.0     vctrs_0.3.0         
[34] nlme_3.1-147         crosstalk_1.1.0.1    xfun_0.13           
[37] stringr_1.4.0        ps_1.3.3             openxlsx_4.1.5      
[40] testthat_2.3.2       lifecycle_0.2.0      gtools_3.8.2        
[43] statmod_1.4.34       scales_1.1.1         hms_0.5.3           
[46] promises_1.1.0       sandwich_2.5-1       lambda.r_1.2.4      
[49] yaml_2.2.1           curl_4.3             memoise_1.1.0       
[52] stringi_1.4.6        desc_1.2.0           plotrix_3.7-8       
[55] pkgbuild_1.0.8       zip_2.0.4            rlang_0.4.6         
[58] pkgconfig_2.0.3      evaluate_0.14        lattice_0.20-41     
[61] purrr_0.3.4          labeling_0.3         htmlwidgets_1.5.1   
[64] processx_3.4.2       tidyselect_1.1.0     plyr_1.8.6          
[67] magrittr_1.5         R6_2.4.1             multcomp_1.4-13     
[70] pillar_1.4.4         haven_2.2.0          whisker_0.4         
[73] foreign_0.8-78       withr_2.2.0          abind_1.4-5         
[76] tibble_3.0.1         crayon_1.3.4         car_3.0-7           
[79] futile.options_1.0.1 rmarkdown_2.1        readxl_1.3.1        
[82] data.table_1.12.8    callr_3.4.3          git2r_0.27.1        
[85] forcats_0.5.0        digest_0.6.25        tidyr_1.0.3         
[88] httpuv_1.5.2         munsell_0.5.0        viridisLite_0.3.0   
[91] sessioninfo_1.1.1   </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
